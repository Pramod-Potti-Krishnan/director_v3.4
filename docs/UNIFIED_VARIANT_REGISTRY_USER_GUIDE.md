# Unified Variant Registry - User Guide

**Version**: 2.0.0
**Last Updated**: 2025-11-29
**Target Audience**: Developers and Content Managers

---

## Table of Contents

1. [Introduction](#introduction)
2. [Quick Start](#quick-start)
3. [Registry Structure Overview](#registry-structure-overview)
4. [Adding a New Variant](#adding-a-new-variant)
5. [Service-Specific Guidelines](#service-specific-guidelines)
6. [Validation and Testing](#validation-and-testing)
7. [Best Practices](#best-practices)
8. [Troubleshooting](#troubleshooting)
9. [Examples](#examples)

---

## Introduction

The Unified Variant Registry is a **single JSON configuration file** that manages all 56+ content generation variants across three services:

- **Illustrator Service v1.0**: LLM-generated visualizations (pyramid, funnel, etc.)
- **Text/Table Service v1.2**: Template-based content layouts (34 variants)
- **Analytics Service v3**: Data visualization charts (18+ chart types)

### Before vs After

**Before (Manual Integration):**
```
❌ 2.5 hours per variant
❌ Edit 5 different Python files
❌ Manual code changes in multiple places
❌ Easy to miss steps or introduce bugs
```

**After (Registry-Based):**
```
✅ 5 minutes per variant
✅ Edit 1 JSON file
✅ JSON schema validation prevents errors
✅ Automatic integration across all Director stages
```

---

## Quick Start

### Adding a New Variant (5-Minute Process)

1. **Open the registry file**:
   ```bash
   code config/unified_variant_registry.json
   ```

2. **Find the appropriate service section**:
   - `illustrator_service_v1.0` - For illustrations
   - `text_service_v1.2` - For text/table layouts
   - `analytics_service_v3` - For charts

3. **Copy an existing variant as a template**

4. **Modify the variant configuration**:
   - Change `variant_id` (must be unique)
   - Update `display_name` and `description`
   - Customize `classification.keywords`
   - Adjust service-specific parameters

5. **Validate and test**:
   ```bash
   python3 -m pytest tests/test_variant_registry_loading.py -v
   ```

6. **Done!** The variant is now available across all Director stages.

---

## Registry Structure Overview

### Top-Level Structure

```json
{
  "version": "2.0.0",
  "last_updated": "2025-11-29",
  "total_services": 3,
  "total_variants": 56,

  "services": {
    "illustrator_service_v1.0": { ... },
    "text_service_v1.2": { ... },
    "analytics_service_v3": { ... }
  },

  "classification_priority_order": [
    "pie_chart",
    "bar_chart",
    "pyramid",
    ...
  ]
}
```

### Service Configuration Structure

Each service has:

```json
"service_name_v1.0": {
  "enabled": true,
  "base_url": "http://localhost:8000",
  "service_type": "llm_generated" | "template_based" | "data_visualization",
  "endpoint_pattern": "single" | "per_variant" | "typed",
  "timeout": 60,

  // Endpoint configuration (depends on pattern)
  "default_endpoint": "/v1.2/generate",  // for "single" pattern
  // OR
  "endpoints": {                          // for "typed" pattern
    "chartjs": "/analytics/v3/chartjs/generate",
    "d3": "/analytics/v3/d3/generate"
  },

  "variants": {
    "variant_id": { /* variant config */ }
  }
}
```

### Variant Configuration Structure

```json
"variant_id": {
  // REQUIRED FIELDS
  "variant_id": "example_variant",
  "display_name": "Example Variant",
  "classification": {
    "priority": 5,
    "keywords": ["keyword1", "keyword2", "keyword3", "keyword4", "keyword5"]
  },

  // OPTIONAL BUT RECOMMENDED
  "description": "Brief description of what this variant does",
  "status": "production" | "beta" | "deprecated" | "disabled",
  "layout_id": "L25",
  "endpoint": "/v1.0/example/generate",  // for per_variant pattern

  // LLM GUIDANCE (highly recommended)
  "llm_guidance": {
    "use_cases": [
      "When to use this variant",
      "Another use case"
    ],
    "best_for": "What this variant excels at",
    "avoid_when": "When NOT to use this variant",
    "examples": [
      {
        "title": "Example Title",
        "key_points": ["Point 1", "Point 2", "Point 3"]
      }
    ]
  },

  // SERVICE-SPECIFIC CONFIGURATIONS
  "parameters": { /* for illustrator */ },
  "data_requirements": { /* for analytics */ },
  "required_fields": [...],  // for text service
  "optional_fields": [...],  // for text service

  "service_specific": {
    "illustrator": { /* config */ },
    "text_service": { /* config */ },
    "analytics": { /* config */ }
  }
}
```

---

## Adding a New Variant

### Step-by-Step Process

#### Step 1: Choose the Right Service

Ask yourself:
- **Illustrator Service**: Is this a visual diagram generated by LLM? (e.g., pyramid, funnel, timeline)
- **Text Service**: Is this a text/table layout using a template? (e.g., comparison table, bullet list)
- **Analytics Service**: Is this a data visualization chart? (e.g., bar chart, line graph)

#### Step 2: Choose a Unique Variant ID

**Rules for `variant_id`:**
- ✅ Lowercase letters, numbers, and underscores only
- ✅ Must start with a letter
- ✅ Use snake_case (e.g., `my_new_variant`)
- ✅ Be descriptive and concise
- ❌ No spaces, hyphens, or special characters
- ❌ No CamelCase or kebab-case

**Examples:**
```
✅ pyramid
✅ bar_chart
✅ matrix_2x2
✅ swot_analysis
✅ gantt_chart_timeline

❌ Pyramid (uppercase)
❌ bar-chart (hyphens)
❌ barChart (camelCase)
❌ bar chart (spaces)
❌ 2x2matrix (starts with number)
```

#### Step 3: Set Classification Priority

**Priority Rules:**
- Lower number = **higher priority** in classification
- Priority range: 1-100
- Consider overlap with existing variants

**Priority Guidelines:**
```
1-3:   Very specific, unique visualizations
4-6:   Common visualizations with clear keywords
7-10:  General-purpose layouts
11+:   Fallback or specialized variants
```

**Current Priority Distribution:**
```
Priority 2:  pie_chart, bar_chart
Priority 4:  pyramid
Priority 5:  funnel
Priority 6:  concentric_circles
Priority 7:  matrix_2x2
Priority 8:  bilateral_comparison
```

#### Step 4: Define Keywords for Classification

**Keyword Strategy:**

Keywords are used by the LLM in **Stage 4 (Generate Strawman)** to classify slides and select appropriate variants.

**Rules:**
- ✅ Minimum 5 keywords required
- ✅ Maximum 200 keywords allowed
- ✅ Include synonyms and variations
- ✅ Include domain-specific terms
- ✅ Include common user phrases
- ❌ No duplicate keywords
- ❌ No empty strings

**Keyword Categories to Include:**

1. **Primary Terms**: Direct names for the variant
   ```json
   ["funnel", "sales funnel", "conversion funnel"]
   ```

2. **Synonyms and Alternatives**:
   ```json
   ["pipeline", "sales pipeline", "lead pipeline"]
   ```

3. **Domain Terms**:
   ```json
   ["tofu", "mofu", "bofu", "lead generation", "qualification"]
   ```

4. **Use Case Phrases**:
   ```json
   ["customer journey", "buyer journey", "conversion process"]
   ```

5. **Variations**:
   ```json
   ["4-stage funnel", "5-stage funnel", "multi-stage funnel"]
   ```

**Example - Comprehensive Keyword Set:**
```json
"keywords": [
  "funnel", "sales funnel", "conversion funnel", "marketing funnel",
  "customer funnel", "pipeline", "sales pipeline", "lead pipeline",
  "awareness", "consideration", "decision", "conversion",
  "tofu", "mofu", "bofu",
  "lead generation", "qualification", "nurturing", "closing",
  "conversion rate", "conversion optimization", "drop-off",
  "customer journey", "buyer journey", "purchase journey",
  "stages of buying", "sales process", "conversion process"
]
```

#### Step 5: Write LLM Guidance

LLM Guidance helps the Director Agent make better variant selections in Stage 4.

**Template:**
```json
"llm_guidance": {
  "use_cases": [
    "Specific scenario 1 (with example)",
    "Specific scenario 2 (with example)",
    "Specific scenario 3 (with example)"
  ],
  "best_for": "One-sentence description of ideal use case",
  "avoid_when": "One-sentence description of when NOT to use",
  "examples": [
    {
      "title": "Concrete Example Title",
      "key_points": [
        "Example point 1 with specifics",
        "Example point 2 with specifics",
        "Example point 3 with specifics"
      ]
    }
  ]
}
```

**Example - Sales Funnel:**
```json
"llm_guidance": {
  "use_cases": [
    "Sales pipelines (Leads → Qualified → Proposals → Closed)",
    "Marketing funnels (TOFU → MOFU → BOFU → Customers)",
    "Customer journey mapping (Awareness → Consideration → Decision)",
    "Conversion optimization processes",
    "Lead qualification stages"
  ],
  "best_for": "Showing volume reduction through stages",
  "avoid_when": "Stages don't have decreasing quantities",
  "examples": [
    {
      "title": "Sales Conversion Funnel",
      "key_points": [
        "Website Visitors (10,000)",
        "Qualified Leads (1,000)",
        "Sales Opportunities (100)",
        "Closed Deals (25)"
      ]
    }
  ]
}
```

---

## Service-Specific Guidelines

### Illustrator Service Variants

**Required Fields:**
- `variant_id`, `display_name`, `classification`
- `endpoint` (path to generation endpoint)
- `parameters` (element count configuration)

**Illustrator Parameters Structure:**
```json
"parameters": {
  "count_field": "num_levels",        // Request field name
  "count_range": {
    "min": 3,                          // Minimum elements
    "max": 6                           // Maximum elements
  },
  "optimal_count": 4,                  // Recommended count
  "element_name": "levels",            // Name for elements
  "required_fields": ["num_levels", "topic"]
}
```

**Illustrator Service-Specific Config:**
```json
"service_specific": {
  "illustrator": {
    "generation_type": "llm_powered",
    "llm_model": "gemini-2.5-flash-lite",
    "character_constraints": true,
    "supports_target_points": true,
    "supports_context": true
  }
}
```

**Complete Illustrator Variant Example:**
```json
"process_timeline": {
  "variant_id": "process_timeline",
  "display_name": "Process Timeline",
  "description": "Sequential process visualization with temporal flow",
  "status": "production",
  "endpoint": "/v1.0/process_timeline/generate",
  "layout_id": "L25",

  "classification": {
    "priority": 5,
    "keywords": [
      "timeline", "process timeline", "sequential process",
      "workflow", "process flow", "step by step",
      "chronological", "temporal", "time-based sequence",
      "project phases", "milestones", "roadmap"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Project timelines and milestones",
      "Product development phases",
      "Onboarding process steps",
      "Sequential workflows"
    ],
    "best_for": "Showing time-based or sequential processes",
    "avoid_when": "Non-sequential or hierarchical relationships"
  },

  "parameters": {
    "count_field": "num_steps",
    "count_range": {"min": 3, "max": 8},
    "optimal_count": 5,
    "element_name": "steps",
    "required_fields": ["num_steps", "topic"]
  },

  "service_specific": {
    "illustrator": {
      "generation_type": "llm_powered",
      "llm_model": "gemini-2.5-flash-lite",
      "character_constraints": true,
      "supports_target_points": true,
      "supports_context": true
    }
  }
}
```

---

### Text/Table Service Variants

**Required Fields:**
- `variant_id`, `display_name`, `classification`
- `required_fields`, `optional_fields`

**Text Service-Specific Config:**
```json
"service_specific": {
  "text_service": {
    "supports_subtitles": true,
    "max_key_points": 8,
    "template_file": "variant_template.html"
  }
}
```

**Complete Text Service Variant Example:**
```json
"pros_cons_table": {
  "variant_id": "pros_cons_table",
  "display_name": "Pros & Cons Table",
  "description": "Two-column comparison of advantages and disadvantages",
  "status": "production",
  "layout_id": "L25",

  "classification": {
    "priority": 7,
    "keywords": [
      "pros and cons", "pros vs cons", "advantages disadvantages",
      "benefits drawbacks", "positives negatives",
      "strengths weaknesses", "for and against",
      "trade-offs", "decision matrix"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Decision analysis",
      "Product evaluation",
      "Option comparison",
      "Risk assessment"
    ],
    "best_for": "Presenting balanced arguments for decision-making",
    "avoid_when": "More than two options need comparison"
  },

  "required_fields": ["variant_id", "title"],
  "optional_fields": ["subtitle", "key_points", "tone", "audience"],

  "service_specific": {
    "text_service": {
      "supports_subtitles": true,
      "max_key_points": 10,
      "template_file": "pros_cons_table.html"
    }
  }
}
```

---

### Analytics Service Variants

**Required Fields:**
- `variant_id`, `display_name`, `classification`
- `data_requirements` (structure, min/max items, value type)

**Data Requirements Structure:**
```json
"data_requirements": {
  "structure": "label_value_pairs" | "time_series" | "multi_series" | "hierarchical" | "network",
  "min_items": 2,
  "max_items": 20,
  "value_type": "numeric" | "categorical" | "mixed",
  "supports_percentages": true
}
```

**Analytics Service-Specific Config:**
```json
"service_specific": {
  "analytics": {
    "library": "chartjs",              // or "d3"
    "chart_type": "doughnut",
    "endpoint_key": "chartjs",          // maps to endpoints config
    "supports_custom_colors": true,
    "supports_data_labels": true,
    "supports_horizontal": false,       // for bar charts
    "supports_stacked": false           // for bar/area charts
  }
}
```

**Complete Analytics Variant Example:**
```json
"doughnut_chart": {
  "variant_id": "doughnut_chart",
  "display_name": "Doughnut Chart",
  "description": "Circular chart with hollow center showing proportions",
  "status": "production",
  "layout_id": "L25",

  "classification": {
    "priority": 3,
    "keywords": [
      "doughnut", "doughnut chart", "donut chart",
      "ring chart", "hollow pie", "circular breakdown",
      "proportion", "percentage", "share distribution"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Budget allocation visualization",
      "Market share with emphasis on total",
      "Resource distribution overview",
      "Composition analysis"
    ],
    "best_for": "Showing parts of a whole with visual emphasis",
    "avoid_when": "More than 8-10 categories"
  },

  "data_requirements": {
    "structure": "label_value_pairs",
    "min_items": 2,
    "max_items": 10,
    "value_type": "numeric",
    "supports_percentages": true
  },

  "service_specific": {
    "analytics": {
      "library": "chartjs",
      "chart_type": "doughnut",
      "endpoint_key": "chartjs",
      "supports_custom_colors": true,
      "supports_data_labels": true
    }
  }
}
```

---

## Validation and Testing

### Validation Workflow

#### 1. JSON Schema Validation (Automatic)

The registry is validated against `config/schemas/unified_registry_schema.json`.

**Common Validation Errors:**

| Error | Cause | Fix |
|-------|-------|-----|
| `String should match pattern '^[a-z][a-z0-9_]*$'` | Invalid `variant_id` format | Use lowercase, underscores, start with letter |
| `Dictionary should have at least 5 items` | Too few keywords | Add more keywords (minimum 5) |
| `Value error, must be unique` | Duplicate keywords | Remove duplicate keywords |
| `Field required` | Missing required field | Add the required field |
| `default_endpoint required for single endpoint pattern` | Missing endpoint config | Add `default_endpoint` field |

#### 2. Pydantic Model Validation (Automatic)

When loading the registry, Pydantic validates:
- Data types are correct
- Ranges are valid (priority 1-100)
- URLs are well-formed
- Cross-field constraints are satisfied

#### 3. Running Tests

**Run all registry tests:**
```bash
python3 -m pytest tests/test_variant_registry_loading.py -v
```

**Run specific test categories:**
```bash
# Test registry loading
python3 -m pytest tests/test_variant_registry_loading.py::TestRegistryLoading -v

# Test service configurations
python3 -m pytest tests/test_variant_registry_loading.py::TestServiceConfig -v

# Test variant configurations
python3 -m pytest tests/test_variant_registry_loading.py::TestVariantConfig -v

# Test classification rules
python3 -m pytest tests/test_variant_registry_loading.py::TestClassification -v

# Integration tests
python3 -m pytest tests/test_variant_registry_loading.py::TestIntegration -v
```

**Expected output:**
```
======================== 26 passed in 0.07s ========================
```

#### 4. Manual Registry Inspection

**Load and inspect the registry in Python:**

```python
from src.models.variant_registry import load_registry_from_file

# Load registry
registry = load_registry_from_file("config/unified_variant_registry.json")

# Check totals
print(f"Services: {len(registry.services)}")
print(f"Total variants: {sum(len(s.variants) for s in registry.services.values())}")

# List all variants
for service_name, service_config in registry.services.items():
    print(f"\n{service_name}:")
    for variant_id in service_config.variants.keys():
        print(f"  - {variant_id}")

# Get specific variant
pyramid = registry.get_variant("illustrator_service_v1.0", "pyramid")
print(f"\nPyramid priority: {pyramid.classification.priority}")
print(f"Pyramid keywords: {len(pyramid.classification.keywords)}")

# Get all variants sorted by priority
sorted_variants = registry.get_variants_by_priority()
print(f"\nTop 5 variants by priority:")
for service, variant_id, variant_config in sorted_variants[:5]:
    print(f"  {variant_config.classification.priority}: {variant_config.display_name}")
```

---

## Best Practices

### Keyword Selection Strategy

**1. Start with Core Terms**
```json
["pyramid", "hierarchical", "hierarchy"]
```

**2. Add Synonyms and Variations**
```json
["organizational structure", "levels", "tiers", "layered"]
```

**3. Include User Language**
```json
["top to bottom", "foundation to peak", "org chart"]
```

**4. Add Domain-Specific Terms**
```json
["maslow", "food pyramid", "reporting structure"]
```

**5. Include Count Variations**
```json
["3 levels", "4 levels", "5 levels", "three tiers"]
```

**Result: 20-50 keywords for robust classification**

### Classification Priority Strategy

**Avoid Priority Conflicts:**

If two variants have the same priority and overlapping keywords, the LLM may struggle to choose between them.

**Strategy:**
1. **Assign unique priorities when possible**
2. **Use keywords to differentiate similar variants**
3. **Test with ambiguous prompts** to see which variant is selected

**Example - Differentiating Similar Variants:**

```json
// Funnel - Priority 5
"keywords": ["funnel", "conversion", "pipeline", "narrowing", "drop-off"]

// Pyramid - Priority 4 (higher priority)
"keywords": ["pyramid", "hierarchical", "levels", "foundation", "top-down"]
```

Even though both are hierarchical, keywords help distinguish:
- "sales funnel" → selects funnel
- "organizational levels" → selects pyramid

### LLM Guidance Best Practices

**Be Specific in Use Cases:**

❌ Poor: "For showing hierarchies"
✅ Good: "Organizational hierarchies (CEO → Directors → Managers → Staff)"

**Provide Concrete Examples:**

❌ Poor: "Use for data comparison"
✅ Good:
```json
{
  "title": "Quarterly Sales Comparison",
  "key_points": [
    "Q1: $2.5M revenue, 15% growth",
    "Q2: $3.1M revenue, 24% growth",
    "Q3: $2.8M revenue, 12% growth"
  ]
}
```

**Clear Avoid-When Guidance:**

❌ Poor: "Don't use for everything"
✅ Good: "Less than 3 or more than 6 levels needed"

### Maintenance Best Practices

**1. Update `last_updated` Field**

Every time you modify the registry:
```json
"last_updated": "2025-11-29"
```

**2. Update Total Counts**

After adding variants:
```json
"total_variants": 57  // was 56
```

**3. Version Control**

Commit registry changes with descriptive messages:
```bash
git add config/unified_variant_registry.json
git commit -m "registry: Add doughnut_chart variant for analytics"
```

**4. Documentation**

For significant changes, update `classification_priority_order`:
```json
"classification_priority_order": [
  "pie_chart",
  "bar_chart",
  "doughnut_chart",  // newly added
  "pyramid",
  ...
]
```

---

## Troubleshooting

### Common Issues and Solutions

#### Issue: "Variant not being selected by LLM"

**Diagnosis:**
- Keywords don't match user prompts
- Priority too low compared to similar variants
- LLM guidance unclear or missing

**Solutions:**
1. Add more keywords that match user language
2. Increase priority (lower number)
3. Improve LLM guidance with specific examples

**Testing:**
```python
# Test classification with sample prompt
from src.agents.director import DirectorAgent

director = DirectorAgent()
result = director.generate_strawman(
    topic="Show our sales pipeline with conversion rates"
)

print(result.slides[0].variant_id)  # Should be "funnel"
```

---

#### Issue: "ValidationError when loading registry"

**Diagnosis:**
Check error message for specific validation failure.

**Common Causes:**

1. **Invalid variant_id format**
   ```
   Error: String should match pattern '^[a-z][a-z0-9_]*$'
   Fix: Change "My-Variant" to "my_variant"
   ```

2. **Too few keywords**
   ```
   Error: List should have at least 5 items
   Fix: Add more keywords to classification
   ```

3. **Duplicate keywords**
   ```
   Error: Keywords must be unique
   Fix: Remove duplicate entries from keyword list
   ```

4. **Missing required fields**
   ```
   Error: Field required
   Fix: Add the missing field (variant_id, display_name, or classification)
   ```

5. **Invalid priority range**
   ```
   Error: Input should be less than or equal to 100
   Fix: Set priority between 1 and 100
   ```

---

#### Issue: "Endpoint not found when generating content"

**Diagnosis:**
- Endpoint pattern doesn't match service configuration
- Endpoint URL is incorrect

**Solutions:**

For **per_variant** pattern:
```json
"endpoint": "/v1.0/my_variant/generate"  // Must match service endpoint
```

For **single** pattern:
```json
// Service config
"default_endpoint": "/v1.2/generate"

// Variant config
// No endpoint field needed - uses default
```

For **typed** pattern:
```json
// Service config
"endpoints": {
  "chartjs": "/analytics/v3/chartjs/generate"
}

// Variant config
"service_specific": {
  "analytics": {
    "endpoint_key": "chartjs"  // Must match key in endpoints
  }
}
```

---

#### Issue: "Tests pass but variant doesn't work in Director"

**Diagnosis:**
- Service adapter not yet implemented (Phase 2)
- Service router not updated (Phase 3)
- Registry loaded but not used by Director

**Solution (Temporary):**

Until Phase 2-3 are complete, variants must still be manually integrated into:
- `src/utils/service_router_v1_2.py`
- Service client files

**Solution (After Phase 3):**

The unified router will automatically handle all registered variants.

---

## Examples

### Example 1: Adding an Illustrator Variant (SWOT Analysis)

```json
"swot_analysis": {
  "variant_id": "swot_analysis",
  "display_name": "SWOT Analysis",
  "description": "Four-quadrant strategic analysis framework",
  "status": "production",
  "endpoint": "/v1.0/swot_analysis/generate",
  "layout_id": "L25",

  "classification": {
    "priority": 6,
    "keywords": [
      "swot", "swot analysis", "strategic analysis",
      "strengths weaknesses", "opportunities threats",
      "strategic planning", "strategic framework",
      "business analysis", "competitive analysis",
      "internal external factors", "strategic assessment",
      "four quadrants", "2x2 strategic matrix"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Strategic planning sessions",
      "Business analysis frameworks",
      "Competitive positioning analysis",
      "Project assessment and planning"
    ],
    "best_for": "Comprehensive strategic analysis with internal/external factors",
    "avoid_when": "Simple pros/cons comparison (use bilateral_comparison instead)",
    "examples": [
      {
        "title": "Product Launch SWOT",
        "key_points": [
          "Strengths: Strong brand, experienced team",
          "Weaknesses: Limited budget, new market",
          "Opportunities: Growing demand, weak competition",
          "Threats: Economic downturn, regulatory changes"
        ]
      }
    ]
  },

  "parameters": {
    "count_field": "num_quadrants",
    "count_range": {"min": 4, "max": 4},
    "optimal_count": 4,
    "element_name": "quadrants",
    "required_fields": ["topic"]
  },

  "service_specific": {
    "illustrator": {
      "generation_type": "llm_powered",
      "llm_model": "gemini-2.5-flash-lite",
      "character_constraints": true,
      "supports_target_points": true,
      "supports_context": true
    }
  }
}
```

---

### Example 2: Adding a Text Service Variant (Executive Summary)

```json
"executive_summary": {
  "variant_id": "executive_summary",
  "display_name": "Executive Summary",
  "description": "Concise overview for leadership audiences",
  "status": "production",
  "layout_id": "L25",

  "classification": {
    "priority": 8,
    "keywords": [
      "executive summary", "executive overview",
      "leadership summary", "high-level overview",
      "c-suite", "board presentation", "strategic overview",
      "key highlights", "executive briefing",
      "management summary", "condensed report"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Board presentations",
      "Executive briefings",
      "Strategic overviews",
      "High-level project summaries"
    ],
    "best_for": "Concise, action-oriented summaries for decision-makers",
    "avoid_when": "Detailed technical content needed",
    "examples": [
      {
        "title": "Q3 Performance Summary",
        "key_points": [
          "Revenue exceeded target by 15% ($12.5M actual vs $10.9M goal)",
          "Customer acquisition up 22% with improved retention (94%)",
          "Recommendation: Expand sales team and increase marketing budget"
        ]
      }
    ]
  },

  "required_fields": ["variant_id", "title"],
  "optional_fields": ["subtitle", "key_points", "tone", "audience"],

  "service_specific": {
    "text_service": {
      "supports_subtitles": true,
      "max_key_points": 5,
      "template_file": "executive_summary.html"
    }
  }
}
```

---

### Example 3: Adding an Analytics Variant (Radar Chart)

```json
"radar_chart": {
  "variant_id": "radar_chart",
  "display_name": "Radar Chart",
  "description": "Multi-dimensional comparison on radial axes",
  "status": "production",
  "layout_id": "L25",

  "classification": {
    "priority": 4,
    "keywords": [
      "radar chart", "spider chart", "web chart",
      "multi-dimensional", "multidimensional comparison",
      "skill assessment", "competency matrix",
      "performance radar", "attribute comparison",
      "polar chart", "star chart",
      "capability assessment", "multi-factor analysis"
    ]
  },

  "llm_guidance": {
    "use_cases": [
      "Skill or competency assessments",
      "Product feature comparisons across multiple attributes",
      "Performance evaluations on multiple dimensions",
      "Competitive analysis with multiple factors"
    ],
    "best_for": "Comparing entities across 4-8 different dimensions",
    "avoid_when": "More than 8 dimensions or time-series data",
    "examples": [
      {
        "title": "Team Skills Assessment",
        "key_points": [
          "Technical Skills: 8/10",
          "Communication: 7/10",
          "Leadership: 6/10",
          "Problem Solving: 9/10",
          "Collaboration: 8/10"
        ]
      }
    ]
  },

  "data_requirements": {
    "structure": "multi_series",
    "min_items": 4,
    "max_items": 8,
    "value_type": "numeric",
    "supports_percentages": false
  },

  "service_specific": {
    "analytics": {
      "library": "chartjs",
      "chart_type": "radar",
      "endpoint_key": "chartjs",
      "supports_custom_colors": true,
      "supports_data_labels": false
    }
  }
}
```

---

## Appendix

### Variant ID Naming Conventions

| Type | Pattern | Examples |
|------|---------|----------|
| Single word | `pyramid`, `funnel`, `timeline` | ✅ |
| Two words | `bar_chart`, `line_graph`, `pie_chart` | ✅ |
| With numbers | `matrix_2x2`, `top_10_list`, `swot_4quadrant` | ✅ |
| Acronyms | `swot_analysis`, `kpi_dashboard` | ✅ |

### Service Type Mapping

| Service Type | Description | Examples |
|--------------|-------------|----------|
| `llm_generated` | AI-generated visual content | Pyramid, Funnel, Timeline |
| `template_based` | HTML template with data | Comparison, Matrix, Lists |
| `data_visualization` | Chart libraries (Chart.js, D3) | Pie, Bar, Line, Scatter |

### Endpoint Pattern Reference

| Pattern | When to Use | Configuration |
|---------|-------------|---------------|
| `single` | One endpoint, variant in body | `default_endpoint` |
| `per_variant` | Dedicated endpoint per variant | `endpoint` per variant |
| `typed` | Multiple endpoints by type | `endpoints` object + `endpoint_key` |

---

## Quick Reference Card

```
┌─────────────────────────────────────────────────────────────┐
│              ADDING A NEW VARIANT - CHECKLIST               │
├─────────────────────────────────────────────────────────────┤
│ □ Choose unique variant_id (lowercase, underscores)        │
│ □ Set display_name (human-readable)                        │
│ □ Write clear description                                  │
│ □ Set classification priority (1-100, lower = higher)      │
│ □ Add 5+ keywords (unique, comprehensive)                  │
│ □ Write LLM guidance (use_cases, best_for, avoid_when)     │
│ □ Add service-specific configuration                       │
│ □ Run validation tests                                     │
│ □ Update total_variants count                              │
│ □ Update last_updated date                                 │
│ □ Commit changes with descriptive message                  │
└─────────────────────────────────────────────────────────────┘
```

---

**Version**: 2.0.0
**Last Updated**: 2025-11-29
**Next**: [Phase 2 - Service Adapter Pattern](PHASE2_SERVICE_ADAPTERS.md)

---

**Questions or Issues?**

- Check the [Troubleshooting](#troubleshooting) section
- Run validation tests: `pytest tests/test_variant_registry_loading.py -v`
- Review examples in `config/unified_variant_registry.json`
